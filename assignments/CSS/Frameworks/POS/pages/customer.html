<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Customer</title>
    <link href="../favIcon.png" rel="icon">
    <meta content="Akila Piumal" name="author">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/css/style.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top"
     style="background-image: linear-gradient(315deg,#00b712 0%,#5aff15 74%);">
    <div class="container-fluid">
        <span class="navbar-brand fw-bolder fs-3 mb-0 text-white h1">
                <img alt="Logo" class="d-inline-block align-text-top" height="30" src="../assets/images/Cart.png"
                     width="30">
                My Shop
            </span>
        <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
                class="navbar-toggler"
                data-bs-target="#navbarSupportedContent" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0 px-5">
                <li class="nav-item">
                    <a class="nav-link" href="home.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="item.html">Items</a>
                </li>
                <li class="nav-item">
                    <a aria-current="page" class="nav-link active text-decoration-underline fw-bold text-white"
                       href="customer.html">Customers</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="order.html">Orders</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="cart.html">Cart</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<main class="container-fluid mt-5 pt-4">
    <div class="mt-1">
        <h3 class="small text-muted">Home > Customers</h3>
    </div>
    <hr class="mb-2 mt-0">

    <section>
        <div class="row mt-3 mx-lg-2">
            <!--select id-->
            <div class="col-5 col-sm-3 col-md-2 pb-2">
                <select aria-label=".form-select-lg example" class="form-select form-select-ls " id="cmbSelectIDOrName">
                    <option selected value="id">ID</option>
                    <option value="name">Name</option>
                </select>
            </div>
            <!--search-->
            <div class="col-12 col-sm-9 col-md-6 col-xl-5 pb-2">
                <div class="d-flex">
                    <input aria-label="Search" class="form-control me-2" id="searchBarCustomer"
                           placeholder="Search Customer">
                    <button class="btn btn-outline-primary" id="btnSearchForCustomer" type="submit">Search</button>
                </div>
            </div>
            <!--add Customer button-->
            <div class="col">
                <div class="col d-flex justify-content-center justify-content-md-end">
                    <button class="btn btn-primary col-7 col-sm-4 col-md-8 col-lg-6 col-xl-4 "
                            data-bs-target="#newCustomerModel"
                            data-bs-toggle="modal"
                            id="newCustomerButton" type="button">+New Customer
                    </button>

                    <!-- New Customer Modal -->
                    <div aria-hidden="true" aria-labelledby="customerModalLabel" class="modal fade"
                         id="newCustomerModel"
                         tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="customerModalLabel">New Customer</h5>
                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal"
                                            type="button"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="container-fluid">

                                        <div class="row">
                                            <div class="col-6 col-md-12">
                                                <label class="form-label" for="customerIdInput">ID</label>
                                                <input class="form-control" id="customerIdInput" type="text">
                                            </div>
                                            <div class="col-6 col-md-12">
                                                <label class="form-label" for="customerNameInput">Name</label>
                                                <input class="form-control" id="customerNameInput" type="text">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12">
                                                <label class="form-label"
                                                       for="customerAddressInput">Address</label>
                                                <input class="form-control" id="customerAddressInput"
                                                       type="text">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="form-label "
                                                       for="customerSalaryInput">Salary</label>
                                                <input class="form-control" id="customerSalaryInput"
                                                       placeholder="1000.00" type="number">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label "
                                                       for="maleOrFemale">Gender</label>
                                                <select class="form-select " id="maleOrFemale">
                                                    <option class="option" id="maleOption">Male</option>
                                                    <option class="option">Female</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="form-label " for="CustomerNumberInput">Contact
                                                    No</label>
                                                <input class="form-control" id="CustomerNumberInput"
                                                       type="number">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer mt-2 d-flex justify-content-center">
                                    <button class="btn btn-outline-success" id="btnSaveCustomer" type="button">Save
                                    </button>
                                    <button class="btn btn-outline-danger" data-bs-dismiss="modal"
                                            type="button">Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--Customer details-->
        <div class="rounded-3 border shadow-lg mt-3 mx-lg-3 bg-success bg-opacity-25">
            <div class="row gx-3 m-3 ">
                <!--Customer ID-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold" for="customerID">Customer ID</label>
                    <input class="form-control" id="customerID" placeholder="C001" type="text">
                </div>

                <!--Customer Name-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold" for="customerName">Customer Name</label>
                    <input class="form-control" id="customerName" readonly type="text">
                </div>

                <!--Customer address-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold" for="customerAddress">Customer Address</label>
                    <input class="form-control" id="customerAddress" readonly type="text">
                </div>

                <!--Customer Salary-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold" for="customerSalary">Customer Salary</label>
                    <input class="form-control" id="customerSalary" readonly type="text">
                </div>

                <!--Gender-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold"
                           for="gender">Gender</label>
                    <input class="form-control" id="gender" readonly type="text">
                </div>

                <!--Contact Number-->
                <div class="col-12 col-sm-6 col-md-4 col-xl-2 text-center text-sm-start text-lg-center">
                    <label class="form-label fw-bold" for="contactNumber">Contact
                        No</label>
                    <input class="form-control" id="contactNumber"
                           readonly type="number">
                </div>

            </div>

            <!--Buttons-->
            <div class="row mb-4 mt-4">
                <div class="d-flex justify-content-center">
                    <!--delete button-->
                    <button class="btn btn-outline-danger col-3 col-md-2 col-lg-1 mx-2"
                            data-bs-target="#addItemModal"
                            data-bs-toggle="modal"
                            type="button">Delete
                    </button>

                    <!--update button-->
                    <button class="btn btn-outline-primary col-3 col-md-2 col-lg-1 mx-2"
                            data-bs-target="#updateCustomerModel"
                            data-bs-toggle="modal"
                            type="button">Update
                    </button>

                    <!-- Update Customer Modal -->
                    <div aria-hidden="true" aria-labelledby="UpdateCustomerModalLabel" class="modal fade"
                         id="updateCustomerModel"
                         tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="UpdateCustomerModalLabel">Update Customer</h5>
                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal"
                                            type="button"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="container-fluid">

                                        <div class="row">
                                            <div class="col-6 col-md-12">
                                                <label class="form-label" for="newCustomer">ID</label>
                                                <input class="form-control" id="newCustomer" readonly type="text"
                                                       value="C004">
                                            </div>
                                            <div class="col-6 col-md-12">
                                                <label class="form-label" for="newName">Name</label>
                                                <input class="form-control" id="newName" type="text">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12">
                                                <label class="form-label"
                                                       for="newAddress">Address</label>
                                                <input class="form-control" id="newAddress"
                                                       type="text">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="form-label "
                                                       for="newSalary">Salary</label>
                                                <input class="form-control" id="newSalary"
                                                       placeholder="1000.00" type="number">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label " for="newPhoneNumber">Contact
                                                    No</label>
                                                <input class="form-control" id="newPhoneNumber"
                                                       type="number">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer mt-2 d-flex justify-content-center">
                                    <button class="btn btn-outline-success" type="button">Save</button>
                                    <button class="btn btn-outline-danger" data-bs-dismiss="modal"
                                            type="button">Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--Clear button-->
                    <button class="btn btn-outline-dark col-3 col-md-2 col-lg-1 mx-2"
                            data-bs-target="#addItemModal"
                            data-bs-toggle="modal"
                            type="button">Clear
                    </button>
                </div>
            </div>
        </div>

        <hr class="mt-4">

        <!--table section-->
        <section class="container-fluid">
            <div class="d-block position-relative overflow-auto" style="height: 300px">
                <table class="table container-lg overflow-hidden text-center">
                    <thead class="text-white" style="background-color: #00b712">
                    <tr>
                        <th scope="col">Customer ID</th>
                        <th scope="col">Customer Name</th>
                        <th scope="col">Customer Address</th>
                        <th scope="col">Customer Salary</th>
                        <th scope="col">Gender</th>
                        <th scope="col">Contact No.</th>
                    </tr>
                    </thead>
                    <tbody id="tblCustomer">

                    </tbody>
                </table>
            </div>
        </section>

    </section>
</main>
<script src="../assets/js/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.33/dist/sweetalert2.all.min.js"></script>
<script>
    var customerArray = [];

    $('#btnSaveCustomer').click(function () {
        let ID = $('#customerIdInput').val();
        let Name = $('#customerNameInput').val();
        let address = $('#customerAddressInput').val();
        let salary = $('#customerSalaryInput').val();
        let gender = $('#maleOrFemale').val();
        let contactNo = $('#CustomerNumberInput').val();

        var customer = {
            id: ID,
            name: Name,
            address: address,
            salary: salary,
            gender: gender,
            contactNo: contactNo
        }

        customerArray.push(customer);

        addDataToTable();

        bindRowClickEvent();

    });

    function addDataToTable() {
        $('#tblCustomer').empty();

        for (var customer of customerArray) {
            var row = `<tr><th scope='row'>${customer.id}</th><td>${customer.name}</td><td>${customer.address}</td><td>${customer.salary}</td><td>${customer.gender}</td><td>${customer.contactNo}</td></tr>`;

            $('#tblCustomer').append(row);
        }

        Swal.fire({
            position: 'top-end',
            icon: 'success',
            title: 'Customer has been saved',
            showConfirmButton: false,
            timer: 1500
        })
    }

    function bindRowClickEvent() {
        $('#tblCustomer>tr').click(function () {
            let id = $(this).children().eq('0').text();
            let name = $(this).children().eq('1').text();
            let address = $(this).children().eq('2').text();
            let salary = $(this).children().eq('3').text();
            let gender = $(this).children().eq('4').text();
            let contactNo = $(this).children().eq('5').text();

            $('#customerID').val(id);
            $('#customerName').val(name);
            $('#customerAddress').val(address);
            $('#customerSalary').val(salary);
            $('#gender').val(gender);
            $('#contactNumber').val(contactNo);
        });
    }

    // key event to ENTER key
    $('#customerID').keypress(function (e) {
        if (e.which == 13) {
            if ($.isEmptyObject(customerArray)) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Empty Set',
                })
            } else {
                for (let i = 0; i < customerArray.length; i++) {
                    if ($('#customerID').val() === (customerArray[i].id)) {
                        $('#customerName').val(customerArray[i].name);
                        $('#customerAddress').val(customerArray[i].address);
                        $('#customerSalary').val(customerArray[i].salary);
                        $('#gender').val(customerArray[i].gender);
                        $('#contactNumber').val(customerArray[i].contactNo);
                        return;
                    }

                }
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Customer not exist'
                })
                $("#customerID").val("");
                $("#customerName").val("");
                $("#customerAddress").val("");
                $("#customerSalary").val("");
                $("#gender").val("");
                $("#contactNumber").val("");
            }

            return false;
        }
    });

    $('#searchBarCustomer').keypress(function (e) {
        if (e.which == 13) {
            searchCustomer();
        }
    });

    $('#btnSearchForCustomer').click(function () {
        searchCustomer();
    });

    function searchCustomer() {
        if ($('#cmbSelectIDOrName').find('option:selected').val() === "id") {
            if ($.isEmptyObject(customerArray)) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Empty Set',
                })
            } else {
                for (let i = 0; i < customerArray.length; i++) {
                    if ($('#searchBarCustomer').val() === (customerArray[i].id)) {
                        $('#customerID').val(customerArray[i].id);
                        $('#customerName').val(customerArray[i].name);
                        $('#customerAddress').val(customerArray[i].address);
                        $('#customerSalary').val(customerArray[i].salary);
                        $('#gender').val(customerArray[i].gender);
                        $('#contactNumber').val(customerArray[i].contactNo);
                        return;
                    }
                }
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Customer not exist'
                })
                $("#customerID").val("");
                $("#customerName").val("");
                $("#customerAddress").val("");
                $("#customerSalary").val("");
                $("#gender").val("");
                $("#contactNumber").val("");
            }
            return false;
        } else if ($('#cmbSelectIDOrName').find('option:selected').val() === "name") {
            if ($.isEmptyObject(customerArray)) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Empty Set',
                })
            } else {
                for (let i = 0; i < customerArray.length; i++) {
                    if ($('#searchBarCustomer').val() === (customerArray[i].name)) {
                        $('#customerID').val(customerArray[i].id);
                        $('#customerName').val(customerArray[i].name);
                        $('#customerAddress').val(customerArray[i].address);
                        $('#customerSalary').val(customerArray[i].salary);
                        $('#gender').val(customerArray[i].gender);
                        $('#contactNumber').val(customerArray[i].contactNo);
                        return;
                    }
                }
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Customer not exist'
                })
                $("#customerID").val("");
                $("#customerName").val("");
                $("#customerAddress").val("");
                $("#customerSalary").val("");
                $("#gender").val("");
                $("#contactNumber").val("");
            }
            return false;
        }
    }

    $("#newCustomerModel").on('shown.bs.modal', function () {
        $(this).find('#customerIdInput').focus();
    });

    $('#customerIdInput').keypress(function (e) {
        if (e.which == 13) {
            $('#customerNameInput').focus();
        }
    });

</script>

<script src="../assets/js/bootstrap.min.js"></script>
</body>
</html>